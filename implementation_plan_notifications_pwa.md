# Implementation Plan - Notifications & PWA

This plan details the steps to upgrade SmartSip with Intelligent Browser Notifications and Progressive Web App (PWA) capabilities.

## User Requirements
1.  **In-App Notifications (Option A):** Instant "Smart Reminders" when the app is open.
2.  **PWA Support (Option B):** Installability, offline capabilities, and service worker registration for future background sync.

## Phase 1: Intelligent In-App Notifications
*Goal: Enable the app to nudge the user locally while open.*

- [ ] **Step 1.1: Notification Logic Hook**
    - Create `src/hooks/useSmartNotifications.js`.
    - Implement permission request (`Notification.requestPermission()`).
    - Implement the "Smart Check" loop (setInterval or useEffect).
    - Logic:
        - Check if `smartAlerts` is enabled.
        - Check if current time is within `alertStartTime` and `alertEndTime`.
        - Check if `lastLogTime` > `alertFrequency`.
        - Check if Daily Goal is NOT met (Don't bug if done).
    - If all True -> `new Notification(...)`.

- [ ] **Step 1.2: Integrate into App.jsx**
    - Import and use the hook in `App.jsx`.
    - Connect Settings state (`smartAlerts`, etc.) to the hook.
    - Add a "Test Notification" button in the Settings screen for user verification.

## Phase 2: PWA Implementation
*Goal: Make the app installable and offline-ready.*

- [ ] **Step 2.1: Dependencies**
    - Install `vite-plugin-pwa`.
    - `npm install vite-plugin-pwa -D`

- [ ] **Step 2.2: Vite Configuration**
    - Modify `vite.config.js` to include `VitePWA` plugin.
    - Define the `manifest` configuration inline (Identity, Colors, Icons).
    - Configure `workbox` strategy (likely `generateSW` for simplicity).

- [ ] **Step 2.3: Asset Generation**
    - Create `public/manifest.json` (auto-generated by plugin usually, but we need logo assets).
    - Create placeholder icons in `public/pwa-192x192.png` and `public/pwa-512x512.png`. (We will generate simple PNGs or SVGs).

- [ ] **Step 2.4: Service Worker Registration**
    - Update `src/main.jsx` (or `index.js`) to register the service worker using `virtual:pwa-register`.
    - Add "New Content Available" toast logic (standard PWA update flow).

- [ ] **Step 2.5: HTML Meta Tags**
    - Update `index.html` with `theme-color`, `apple-touch-icon`, and `viewport` optimizations.

## Phase 3: Verification
- [ ] **Step 3.1: Browser Test**
    - Verify "Test Notification" works.
    - Verify "Smart Reminder" triggers after wait time (simulated).
- [ ] **Step 3.2: PWA Test**
    - Run `npm run build` and `npm run preview`.
    - Check Lighthouse PWA score.
    - Check "Install App" icon appears in browser bar.
